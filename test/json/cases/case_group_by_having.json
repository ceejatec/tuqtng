
[
    {
        "description": "reference a field in the projection not in the group by",
        "statements": "SELECT title, type, COUNT(*) AS count FROM catalog GROUP BY type",
        "error": "Semantic Error - cause: The expression catalog is not satisfied by these dependencies"
    },

    {
        "description": "simple group by usage",
        "statements": "SELECT type, COUNT(*) AS count FROM catalog GROUP BY type",
        "results": [
        {
            "count": 1,
            "type": "Book"
        },
        {
            "count": 2,
            "type": "Movies&TV"
        }
    ]
    },

    {
        "description": "use all aggregate functions, no group by",
        "statements": "SELECT MIN(pricing.list) AS min, MAX(pricing.list) AS max, AVG(pricing.list) AS avg, SUM(pricing.list) AS sum, COUNT(pricing.list) AS count FROM catalog",
        "results": [
        {
            "avg": 566,
            "count": 3,
            "max": 799,
            "min": 300,
            "sum": 1698
        }
    ]
    },

    {
        "description": "use all aggregate functions, this type with group by",
        "statements": "SELECT type, MIN(pricing.list) AS min, MAX(pricing.list) AS max, AVG(pricing.list) AS avg, SUM(pricing.list) AS sum, COUNT(pricing.list) AS count FROM catalog GROUP BY type",
        "results": [
        {
            "avg": 300,
            "count": 1,
            "max": 300,
            "min": 300,
            "sum": 300,
            "type": "Book"
        },
        {
            "avg": 699,
            "count": 2,
            "max": 799,
            "min": 599,
            "sum": 1398,
            "type": "Movies&TV"
        }
    ]
    },

    {
        "description": "use all aggregate functions, with group by and having",
        "statements": "SELECT type, MIN(pricing.list) AS min, MAX(pricing.list) AS max, AVG(pricing.list) AS avg, SUM(pricing.list) AS sum, COUNT(pricing.list) AS count FROM catalog GROUP BY type HAVING count(pricing.list) > 1",
        "results": [
        {
            "avg": 699,
            "count": 2,
            "max": 799,
            "min": 599,
            "sum": 1398,
            "type": "Movies&TV"
        }
    ]
    },

    {
        "description": "use array aggregate function",
        "statements": "SELECT ARRAY_AGG(asin) AS agg FROM catalog",
        "results": [
        {
            "agg": [
                "B0094QY7HE",
                "B0094QY3AB",
                "B0094QY3LI"
            ]
        }
    ]
    },

    {
        "statements": "SELECT orderlines[1], count(*) AS count FROM orders GROUP BY orderlines[1]",
        "results": [
        {
            "$1": {
                "productId": "sugar22",
                "qty": 1
            },
            "count": 3
        },
        {
            "$1": {
                "productId": "tea111",
                "qty": 1
            },
            "count": 1
        }
    ]
    },

    {
        "statements": "SELECT orderlines,  count(*) AS count FROM orders GROUP BY orderlines",
        "results" : [
        {
            "count": 2,
            "orderlines": [
                {
                    "productId": "coffee01",
                    "qty": 1
                },
                {
                    "productId": "sugar22",
                    "qty": 1
                }
            ]
        },
        {
            "count": 1,
            "orderlines": [
                {
                    "productId": "coffee01",
                    "qty": 2
                },
                {
                    "productId": "tea111",
                    "qty": 1
                }
            ]
        },
        {
            "count": 1,
            "orderlines": [
                {
                    "productId": "tea111",
                    "qty": 1
                },
                {
                    "productId": "sugar22",
                    "qty": 1
                }
            ]
        }
    ]
    },

    {
        "statements": "SELECT details.director AS D, count(*) AS count FROM catalog WHERE ANY director OVER director IN details.director  END GROUP BY details.director HAVING LENGTH(details.director) > 1",
        "results": [
        {
            "D": [
                "Euros Lyn",
                "Paul Mcguigan"
            ],
            "count": 1
        }
    ]
    },

    {
        "statements": "SELECT title, SUM(dimensions.length), SUM(dimensions.width) FROM catalog WHERE dimensions.height > 0.5 AND ANY gen = \"Thriller\" OVER gen IN details.genre END GROUP BY title HAVING SUM(dimensions.width) > 1 and SUM(dimensions.length) > 1",
        "results": [
        {
            "$1": 7,
            "$2": 12,
            "title": "Inferno"
        },
        {
            "$1": 2,
            "$2": 2.5,
            "title": "Zero Dark Thirty"
        },
        {
            "$1": 2,
            "$2": 1.5,
            "title": "Sherlock: Series 1"
        }
    ]
    }



]
